---
layout: post
title: "Selenium"
excerpt: "Robot control to Seleniumtastic your web apps"
shorturl: "https://goo.gl/"
tags: [ML, GE]
image:
# feature: banner-eclipse-1900x500-321k.png
  feature: https://user-images.githubusercontent.com/300046/28752993-0d1437a4-74fa-11e7-99cc-ed04f625174c.png
  credit: 
  creditlink: 
comments: true
---
<i>{{ page.excerpt }}</i>
<hr />

{% include _toc.html %}

This article contains notes on installing, coding, and running Selenium.

1. <a name="#Obtain">Obtain jars and drivers</a>
2. <a name="#CodeJava">Code a basic starter</a> (Java in Selenium driving Chrome).
3. Add Firefox browser for cross-browser testing.

4. <a href="#ReadCSV">Add CSV data processing</a>
5. <a href="#Excel">Add Excel data processing</a>

6. Add OpenQA via SikuliX2
7. Add Tesseract

<hr />


<a name="Obtain"></a>

## Obtain jars and drivers #

There are the ways to assemble what Selenium needs:

a). <a href="#CopyEstablished">Copy a working Selenium project</a>
   that already has the files needed. Then edit it for your own uses.
   This is the quickest and simplest way.

b). Copy set of jars from an in-house binary respository (such as Nexus or Artifactory).

c). Code in pom.xml and run Maven (or equivalent tool such as Ant).

d). <a name="ManualDownload">Manual download from websites</a>,
   which you'll need to do when a new version comes along. 

e). Build from source.


PROTIP: Download all the latest install files at one sitting to test compatibility of the set.
Assemble them together in a single folder for copying into each Selenium project folder
so each can stand alone when distributed.

<a target="_blank" href="http://www.softwaretestinghelp.com/how-to-use-different-browsers-drivers-for-your-selenium-script/">
This</a> explains the driver operation.


<hr />


<a name="CopyEstablished"></a>

## Copy established Selenium project

git clone https://github.com/wilsonmar/selenium-samples

* SeleniumHello1 is used to verify whether the Selenium core install works.
* SeleniumFirefoxGoogleSearch1 
* SeleniumGoogleSearch1 works on multiple browsers.


<a name="SeleniumBasic"></a>

## Selenium Chrome Java setup #

Let's start with the bare minimum Selenium setup and run a script
(we'll add JUnit, IE, Firefox, etc. later).

https://www.youtube.com/watch?v=zylSll8hsPs

Drivers for browsers go into the Reference folder.

https://www.youtube.com/watch?v=9IoP45r5Ap4&t=21s
How to Install Selenium WebDriver With Java And Maven On Mac OS X10 - a 13 Minute SpeedRun

https://www.youtube.com/watch?v=nq97dfaVmC4


<a name="ManualDownload"></a>

## Manual Download

PROTIP: Download files for all operating systems so the scripts begin as cross-system capable
(works on Windows, Mac, Linux).

1. Go to
   <a target="_blank" href="http://docs.seleniumhq.org/download/">
   http://docs.seleniumhq.org/download</a>

0. Under the "Selenium Standalone Server" section heading, click the link
   next to "Download version":<br />

   Download version <a target="_blank" href="https://goo.gl/mFtw7n">3.5.0</a>

0. Click Save of file named with the same version number, such as:<br />
   <strong>selenium-server-standalone-3.5.0.jar</strong><br />
   to the Downloads folder.

   #### Java bindings

0. Under the "Selenium Client & WebDriver Language Bindings" section heading, click the link
   click the <a target="_blank" href="http://selenium-release.storage.googleapis.com/3.5/selenium-java-3.5.0.zip">Download</a>
   link associated with the programming language you use, such as Java.

0. Click Save of file named with the same version number, such as:<br />
   <strong>selenium-java-3.5.0.zip</strong><br />
   to the Downloads folder.


   #### Windows Internet Explorer driver

   <a target="_blank" href="https://www.youtube.com/watch?v=knMH7phD7Hs">
   VIDEO</a>

0. On Windows only, under "The Internet Explorer Driver Server" section heading, 
   click the link 
   <a target="_blank" href="https://goo.gl/GwYYmg">64-bit Windows IE</a>

0. Click Save of file named with the same version number, such as:<br />
   <strong>IEDriverServer_x64_3.5.0.zip</strong><br />
   to the Downloads folder.


   #### Mac Safari WebDriver

   This section is only applicable on an Apple Mac.

   <a target="_blank" href="https://www.youtube.com/watch?v=wKgDrjBM0pw">
   VIDEO</a>

   Under the "Safari" section heading in the
   <a target="_blank" href="https://github.com/SeleniumHQ/selenium/wiki/SafariDriver">
   Selenium webpage</a>, the 
   SafariDriver.safariextz file is <strong>deprecated</strong>.
   So no need to download it.

   Starting with Safari 10 that comes with OS X El Capitan and macOS Sierra,
   <a target="_blank" href="https://webkit.org/blog/6900/webdriver-support-in-safari-10/">
   in 2016</a>, WebKit running Java 1.8+ supports the new
   <a target="_blank" href="https://www.w3.org/TR/webdriver/">
   W3C WebDriver</a> browser automation API.
   So Selenium automatically launches the driver without further configuration.
 
   However, it needs to be enabled becuase it's off by default.

0. Open the Safari browser.
0. Press command+, (comma) or in the menu bar, select Safari | Preferences | Advanced tab (wheel icon).
0. Check "Show Develop menu in menu bar" to see "Develop" appear in the menu bar behind the dialog. Exit the dialog.
0. Click "Develop" on the menu bar and select "Allow Remote Automation".

   Authorize safaridriver to launch the webdriverd service which hosts the local web server. 

0. Open a Terminal window to run:

   <tt><strong>cd /usr/bin<br />
   ./safaridriver -p 5678
   </strong></tt>

   BLAH: The response asks for a port number.

   <pre>
Usage: safaridriver [options]
   -h, --help                Prints out this usage information.
   -p, --port                Port number the driver should use. If the server
                             is already running, the port cannot be changed.
                             If port 0 is specified, a default port will be used.
   </pre>

0. Complete the authentication prompt.

0. To verify, run the Selenium script:

   SeleniumSafariGoogleSearch1.java


   #### Binary repository

   An alternative download location is:

   <a target="_blank" href="https://selenium-release.storage.googleapis.com/index.html">
   https://selenium-release.storage.googleapis.com/index.html</a>


## Eclipse IDE


   ### New Lib folder

0. Within Eclipse, right-click on your project name to select New, Folder.
0. Type in name "lib" (for library). Finish.

   #### Server into lib folder

0. Press command+tab to switch to the File Explorer window.
0. Drag from within the Downloads folder file <br />
   selenium-server-standalone-3.5.0.jar<br />
   and drop it within the lib folder when the mouse turns into a "+" sign.
0. Click OK to the pop-up dialog for Copy files.

   #### Selenium Java into lib folder

0. Press command+tab to switch to the File Explorer window.
0. Within the Downloads folder, unzip by double-clicking on file <br />
   selenium-java-3.5.0.zip. 

   <a target="_blank" href="https://www.youtube.com/watch?v=wlZVSud2vdg">
   On a Mac</a>, this should result in the creation of folder<br />
   <strong>selenium-java-3.5.0</strong>. But 
   <a target="_blank" href="http://osxdaily.com/2013/02/13/open-zip-cpgz-file/">"
   if you see a <strong>.cpgz</strong> file created, 
   move that to trash and use another utility such as the "RAR Extractor" utility 
   or unzip in a Terminal window.

0. Dive into the folders to drag <br />
   <strong>selenium-java-3.5.0.jar</strong><br />
   to the lib folder.

0. Click OK to the pop-up dialog for Copy files.


   ### Eclipse folder

0. In Eclipse, press command + I or 
   right-click on your project to select <strong>Properties</strong>.
0. At Resource, Location is the path of the project.
0. Click on the door icon and a Finder window opens up.

   ### new References folder for Browser drivers

   <a target="_blank" href="https://www.youtube.com/watch?v=zylSll8hsPs&t=6m45s">
   VIDEO</a>:

0. Double-click to expand selenium-java-3.5.0.zip. 
0. Drill down to the "selenium-3.5.0" folder.
0. Drill down to that jar.
0. Drag the <strong>client-combined-3.5.0-nodeps.jar</strong> into the lib folder. ???
0. Choose Copy Files. OK.
0. Drill down into the lib folder within the selenium-java-3.5.0 folder.
0. Select all the files.

   NOTE: Previous versions did not include JUnit and others.

0. Drag them all into the lib folder. 
0. Choose Copy Files. OK.


   ### Establish lib as References

   <a target="_blank" href="https://www.youtube.com/watch?v=zylSll8hsPs&t=7m11s">
   VIDEO</a>:

   To make Eclipse recognize the jar files:

0. Highlight the two files in the lib folder.

   Click first file. Hold Cntrl while clicking the second file.   

0. Right-click for <strong>Build Path</strong>. Add to Build Path.

   A <strong>Referenced Libraries</strong> item should appear under Package Explorer.


   ### Use Chrome driver

   <a target="_blank" href="https://www.youtube.com/watch?v=-stXyMIrsck&t=11s">
   VIDEO</a>:

0. Navigate to<br />
   <a target="_blank" href="http://chromedriver.storage.googleapis.com/index.html">
   http://chromedriver.storage.googleapis.com/index.html</a>

0. Scroll down to click the LATEST_RELEASE so it downloads.
0. Open the file to see the version number (2.31 at time of writing).
0. Scroll down to that largest version number and click on it.
0. Click the file for your operating system, such as<br />
   chromedriver_mac64.zip.
0. Unzip it to file <strong>chromedriver</strong> Unix executable.
0. Copy the chromedriver file to <strong>/usr/local/bin</strong> folder.
0. Restart your Chrome
0. Try your Selenium WebDriver code.
   

   ### Use Gecko Firefox driver

   <a target="_blank" href="https://www.youtube.com/watch?v=21dK8q3BOZU&t=1m27s">
   Video</a> 26 May 2016

0. Navigate to<br />
   <a target="_blank" href="https://github.com/mozilla/geckodriver/releases">
   https://github.com/mozilla/geckodriver/releases</a>

   The "Latest release" is shown at the top. Later releases are below.

   Mozilla also calls it the "Marionette Proxy".

0. Scroll down to the Downloads section and click on the file for your operating system.

   geckodriver-v0.18.0-macos.tar.gz for Mac (1.31 MB)

   geckodriver-v0.18.0-win64.zip for Windows

0. Unzip the macos file for the <strong>geckodriver</strong> executable.

0. Unzip the win64 file for the <strong>geckodriver.exe</strong> executable.

0. Copy the chromdriver file to <strong>/usr/local/bin</strong> folder. ???
0. Restart your system and try your Selenium WebDriver code as 
   shown in video.



   ### Headless drivers 

   Ghost Driver or PhantomJS turns Selenium "headless",
   accessing the DOM.

   HTML Unit from
   https://selenium-release.storage.googleapis.com/index.html
   selenium-html-runner-3.5.0.jar


   ### Junit into lib folder

0. Navigate to<br />
   <a target="_blank" href="http://sourceforge.net/projects/junit/files/junit/">
   http://sourceforge.net/projects/junit/files/junit</a>
0. Click the text to the right of "Looking for the latest version?",
   such as <strong>Download junit-4.10.jar (253.2 kB)</strong>.
   
   This downloads file <strong>junit-4.10.jar</strong> (from 2011).

0. Drag from within the Downloads folder file <br />
   junit-4.10.jar<br />
   and drop it within the lib folder when the mouse turns into a "+" sign.



   ### New Class

0. In the Package Explorer, right-click on "src". Select New, Java Class.
0. For Package, type "com.demo.testcases".
0. For Name, type "SeleniumFirefoxDemo1".
0. Check "public static void main(Strong[] args)". Finish.

<hr />

## IntelliJ IDE

   <a target="_blank" href="https://www.youtube.com/watch?v=ff5ZsthcSZw">
   VIDEO: How to Install Java, Maven and IntelliJ on Apple Mac</a>


## Add-on functionality

   <a name="ReadCSV"></a>

   ### Read CSV files

   So your Selenium Java code can read CSV files:

   Specify the dependency in Maven, Ant, etc.
   or

0. Download from
   https://mvnrepository.com/artifact/net.sf.opencsv/opencsv/

   opencsv-2.3.jar

0. Add in your Java code:

   ```
     List<MyBean> beans = new CsvToBeanBuilder(FileReader("yourfile.csv"))
       .withType(Visitors.class).build().parse();
   ```

   
   <a name="Excel"></a>

   ### Read Excel files

   <a target="_blank" href="https://www.youtube.com/watch?v=sbBdj4zIMqY">
   VIDEO</a>: So your Selenium Java code can read Excel files: 

0. Download Apache POI - the Java library for Microsoft documents from<br />
   <a target="_blank" href="https://poi.apache.org/download.html">
   https://poi.apache.org/download.html</a><br />
   the binary distribution for the latest stable version, such as<br />
   poi-bin-3.16-20170419.tar.gz

0. Unzip using RAR so you don't extract 

0. Select the file under the HTTP heading.


<a name="EclipsePlugins"></a>

### Eclipse Plug-ins #

* Checkstyle

* EclEmma - Java Code Coverage for Eclipse

* Spelling checking

* Formatter


<a name="Tutorials"></a>

## Video Tutorials #

   * <a target="_blank" href="https://www.youtube.com/watch?v=zylSll8hsPs">
   Selenium WebDriver Eclipse Java Project Setup: For the absolute beginner</a>
   on Windows with Java 1.6 [13:58]

   * <a target="_blank" href="https://www.youtube.com/watch?v=BJAKDaaWfh0&t=20s">
   Introduction to Eclipse: Driving Java Productivity</a> from 2012
   by Marakana

Pluralsight.com has a two-part series on Eclipse
from 2013 by Tod Gentille (@Tod Gentille) of syncorsystems.com:

   * <a target="_blank" href="https://app.pluralsight.com/library/courses/eclipse-guided-tour-part1/table-of-contents"> Part 1</a>
   * <a target="_blank" href="https://app.pluralsight.com/library/courses/eclipse-guided-tour-part2/table-of-contents"> Part 2</a>

## Shortcuts

To go back to previous edit location: Control+Q

* <a target="_blank" href="https://www.youtube.com/watch?v=C5glFtpuy0U">
   Keyboard shortcuts</a> for constructors.

   <a target="_blank" href="http://goo.gl/OI9DU">Cheatsheet at http://goo.gl/OI9DU</a>

https://www.youtube.com/watch?v=ZUM9jEhLie0

https://www.youtube.com/watch?v=E3hKgb4aLHM

https://www.youtube.com/watch?v=X8Xw7FWw49E

https://www.dropbox.com/s/inuirqwhlr3w7zf/slides.pdf?dl=0
Dave Hoeffer