---
layout: post
title: "Swim.it Cloud Evaluation"
excerpt: "Here is how your Internet of Things gets massive, fast"
tags: [IoT, cloud]
image:
# pic jessica nedved swimming 1900x500-c70.jpg
  feature: https://cloud.githubusercontent.com/assets/300046/16708828/1e020bc6-45bd-11e6-9b1d-efb4246989c2.jpg
  credit: Jessica Nedved
  creditlink: http://www.jessicanedved.com/blog/?p=29
comments: true
---
<i>{{ page.excerpt }}</i>
<hr />

{% include _toc.html %}

This tutorial aims to enable someone with minimal tech experience to critically evaluate the internals of
<a target="_blank" href="http://www.swim.it/">swim.it</a> 
cloud service using its sample code.

Instead of waving confusing marketing hype and technical buzzwords in front of you,
this tutorial <strong>shows</strong> you the technical details in context 
as we go <strong>hands-on</strong> through the step-by-step instructions,
with NOTEs and PROTIPs commentary along the way.

To examine the interaction between server and your potential client,
we take a "deep dive" into the operation of a sample client program,
which has functionality common to most other programs:

   0. <a href="#Land">Land (open) a websocket page</a> to see what libraries are downloaded
   0. <a href="#SignIn">Sign-in</a> and see what is exchanged
   0. <a href="#AddChannel">Add a Chat Channel</a> to see group-level communication among several users
   0. <a href="#SignOut">Sign-out</a>

By carefully sequencing the commentary below,
we minimize the "mental gymastics" one has to do to understand the many technologies involved.

This includes explanation of 3rd party utilities such as Homebrew tap, etc.

This article explains these buzzwords in context, listed alphabetically here:

   * Actor Model
   * Android
   * <a href="#Push">asynchronous</a>
   * <a href="#Push">bi-directional</a>
   * <a href="#EndPoint">end-point</a>
   * iOS 
   * <a href="#Push">IoT</a>
   * <a href="#LowLatency">low latency</a>
   * <a href="#Multiplexing">multiplexes</a>
   * <a href="#Push">Peer-to-Peer messaging</a>
   * persistent links subscription
   * <a href="#Push">push network</a>
   * reactive
   * <a href="#Push">real-time</a>
   * <a href="#Stateful">stateful</a> vs. stateless
   * <a href="#REST">REST HTTP</a>
   * Scala
   * SDK
   * streams

   TODO: Add links to explanations of each of the buzzwords above.
   
## Wiki plan #

   Transparency of progress is presented in the wiki at:<br />
   <a target="_blank" href="https://github.com/swimit/swim-examples/wiki">
   https://github.com/swimit/swim-examples/wiki</a>

   Sure, "anyone" can code this library (in a 24 hour hackathon), 
   but this team has done it
   but putting together all the other many aspects of a software development organization.
   See my list of [what a Developer Evangelist needes to consider](/evangelist/).

   The SWIM.it organization makes its money (has a "business model") 
   from charging for traffic on servers the company sets up in the cloud or on-premesis.

<a name="Land"></a>

## Land (open) a websocket page #

Let's begin by looking at how the SWIM company's sample app 
interacts with their SWIM cloud.

0. Open a Google Chrome internet browser window.
0. Invoke Chrome's Developer Tools by selecting the "hamburger" icon at the upper right or 
   pressing option + command + I on Macs or Ctrl + Shift + I on Windows machines.
0. Select multiple windows for the app and the debugger:

   <amp-img width="368" height="136" alt="chrome debugger dock side 20160709-368x136-c82"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16711802/bddae87a-462b-11e6-8483-d18565869121.png">
   </amp-img><br /><br />

0. Mouse over the red button at the upper-left of the Debugger pane to make sure it's <strong>recording</strong>.

0. Specify this URL:

   <a target="_blank" href="http://chat.swim.it/#/chat/public">
   http://chat.swim.it/#/chat/public</a>

   <amp-img width="324" height="103" alt="swim chat client screen 324x103-c67.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16707566/7fbdf866-4590-11e6-800b-371d8d3cb18c.jpg">
   </amp-img><br /><br />

   NOTE: This communicates with a SWIM service running within the AWS EC2 public cloud infrastructure.

0. Click <strong>Sign In</strong> at the lower left.
0. Select your Google account in the pop-up window that appears.

   We're assuming that you have a Google account.

0. Click Allow for the app's client to appear.

   <amp-img width="650" height="297" alt="swim chat client logged in 650x297-c62.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16707596/ac65cbcc-4591-11e6-9d93-529dbcbc4de3.jpg">
   </amp-img><br /><br />

   <a name="websockets"></a>

   ### Websockets open #

0. Switch to the Developer Tool screen. On a Mac, press command + ` (back-tick).

   <a name="waterfallchart"></a>

   ### Waterfall timeline #    

0. Click the "Network" tab to see the "waterfall timeline" of network activity.

   <amp-img width="650" height="222" alt="swim chrome websocket 20160709-650x222-c59.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16712998/567f35f2-4656-11e6-9386-1897731ae4d1.jpg">
   </amp-img><br /><br />

   NOTE: The length of each line at the right visually illustrates how much time it took to download that file.

   In the case of Type <strong>websocket</strong>, its Time is "Pending" and the blue line continues
   far out in time because websockets are <strong>continuously open</strong> connection
   to "messenger swim services".

   The definition of the websockets protocol by the Internet Engineerng Task Force (IETF) at
   <a target="_blank" href="https://tools.ietf.org/html/rfc6455">
   https://tools.ietf.org/html/rfc6455</a>:
   "The goal of
   this technology is to provide a mechanism for browser-based
   applications that need two-way communication with servers that does
   not rely on opening multiple HTTP connections (e.g., using
   XMLHttpRequest or <iframe>s and long polling)."

   Thus, the WebSockets protocol is what enables a <strong>continuously open</strong>
   channel of communication between client and server,
   which removes the time ("latency") loss from having to open a connection.

   <a name="Push"></a>

   ### Push real-time #

   When communication lanes are continuosly open, the server can <strong>push</strong>
   information to the client rather than waiting for clients to initiate communication.

   This communication is called "asynchronous" because the client does not wait
   for a request to be returned before sending another request,
   which is <strong>"synchronous"</strong> behavior.

   Not waiting means server and client are communicating as "peers" (like sibilings).
   This is why such communication is called "peer-to-peer messaging".

   This <strong>bi-directional</strong> initiation of communications is crucial for
   <strong>real-time</strong> flow of information needed for IoT (Internet of Things).

   <a name="LowLatency"></a>

   ### Low latency #

   In the <a href="#waterfallchart">waterfall timeline</a>,
   notice the "135 ms" (millseconds) latency time to obtain the
   "chat.swim.it" document. That's about a tenth of a second.

   Remember that 100 milliseconds is what it takes for light to travel around the earth's 20,000 miles.
   So the latency is about as good as it gets.

   <a name="httpheaders"></a>

   One reason for this low latency is that the websocket protocol is more compact in its communication.
   Each communication sent consists of a header and a body.
   The websocket protocol uses a smaller number of bytes than the protocol used by most websites in 2016.

   See <a target="_blank" href="https://en.wikipedia.org/wiki/WebSocket">
   https://en.wikipedia.org/wiki/WebSocket</a>

   As can be expected, the larger the file, the more time it takes to download.
   Here is the general trend, which can vary depending on internet weather between client and server
   at each paticular point in time:
   <amp-img width="566" height="369" alt="swim client downloads size seconds 20160710-566x369-c67.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16713780/15994550-466f-11e6-89b5-3d30f5e2d07c.jpg">
   </amp-img><br /><br />

   The individual files downloaded are discussed in a <a href="#ClientLibs">forthcoming section</a>.


   <a name="Status340"></a>

   ### Status 304 Not Modified #

   Incidentally, in the <a href="#waterfallchart">waterfall timeline</a>, 
   the "304" under the "Status" column means,
   according to <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status">
   those who make browsers</a> and <a target="_blank" href="https://httpstatuses.com/304">blog</a>,
   means "Not modified", or the server's way of saying that 
   the client can continue to use same cached version of the resource requested again.


   <a name="Scalability"></a>
   <a name="Stateful"></a>

   ### Scalability from statefulness #

   HTTP was designed to establish a connection <strong>each time</strong> it wants to send a message to the server.
   This enables what is called a "stateless" design that allows a particular client to go to any specific server
   rather than being "pinned" to a particular server.

   By contrast, a constant connection is called "stateful" because the state or status of communication is maintained.
   Websockets maintain a constantly open connection, so it has a "stateful" design.

   The advantage of a stateful design for communication is that it doesn't have the same <strong>overhead</strong>
   as stateful designs.

   In <a target="_blank" href="http://www.tutorialspoint.com/websockets/websockets_api.htm">
   this</a> comparative bar chart of 
   the total amount of time spent communicating:

   <amp-img width="600" height="292" alt="websocket vs rest http stats 600x292-c71.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16714340/dabd1066-467c-11e6-8e9d-e13c72b7c3a1.jpg">
   </amp-img>

   As the total number of messages between the same client and server increases 
   (such as with many IoT devices),
   the overhead in use of HTTP REST adds up a lot versus websocket communication time with less overhead.

   Additional scalability is provided by 
   execution of Swim services being distributed across several <strong>clusters</strong> of several servers each.


   <a name="Multiplexing"></a>

   ### Multiplexing #

   One of the limiations with HTTP v1 protocol is that there is a limitation on how many connections a server can support.
   
   The websockets procotol makes use of multiplexing techniques,



   <a name="ClientLibs"></a>

   ### Chat client libraries #

   To get a better understanding of the actual code:

0. Alt-click on the demo chat client webpage to <strong>View Page Source</strong>.

   <amp-img width="650" height="71" alt="swim client code 20160710-650x71-c64.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16713851/ca6b7de4-4670-11e6-9129-e0453890b0d8.jpg">
   </amp-img>

   The source downloaded is (rightly) minified of 
   white space and line breaks for smaller and thus quicker usage,
   using an on-line tool such as <a target="_blank" href="http://dean.edwards.name/packer/">
   Packer</a>.

   Tools to un-pack include:

   * <a target="_blank" href="http://mrcoles.com/blog/css-unminify/">
   This webpage</a> un-minifies CSS (also as npm install cssunminifier)

   * <a target="_blank" href="http://jsbeautifier.org/">
   This webpage</a> un-minifies JavaScript. But note minification may change internal variable names to a single letter and removes code comments.

   <img align="right" width="217" height="482" alt="swim chat chrome menu 20160710-217x482-c64.jpg"
   src="https://cloud.githubusercontent.com/assets/300046/16717509/1a8f369a-46d4-11e6-9a45-a5a4ec0c4e0c.jpg">
   Minification in external libraries makes it difficult to add break points in the Developer Tools.

   * <a target="_blank" href="http://chat.swim.it/scripts/modernizr.js">modernizr.js</a> (by Paul Irish)

   * <a target="_blank" href="http://chat.swim.it/scripts/jquery/jquery.min.js">jquery.min.js</a> v2.2.1 from http://jquery.com/ - https://cdnjs.com/libraries/jquery/ or https://developers.google.com/speed/libraries/

   * <a target="_blank" href="https://apis.google.com/js/platform.js">https://apis.google.com/js/platform.js</a> for Google Sign-in - see https://developers.google.com/identity/sign-in/web/sign-in


   Libraries unique (custom) to the app:

   * <a target="_blank" href="http://chat.swim.it/styles/app.min.css">styles/app.min.css</a> 
   based on <a target="_blank" href="https://github.com/necolas/normalize.css">
   github.com/necolas/normalize.css</a> 
   for a "modern alternative to CSS resets" that
   1) correct the line height in all browsers and 2) prevent adjustments of font size after orientation changes in IE and iOS.

   * <a target="_blank" href="http://chat.swim.it/scripts/app.min.js">scripts/app.min.js</a>
   <a name="Angular"></a>

   ### Angular 1 download #

   JavaScript in Angular v1 (from <a target="_blank" href="http://angularjs.org">http://angularjs.org</a>)
   generate and display HTML from this CSS tag:

   <pre>
   &LT;div ui-view="main" class="main-view">
   </pre>

   The libraries specified for download:

   * <a target="_blank" href="http://chat.swim.it/scripts/angular/angular.min.js">scripts/angular/angular.min.js</a>  v1.4.9
   * <a target="_blank" href="http://chat.swim.it/scripts/angular/angular-animate.min.js">scripts/angular/angular-animate.min.js</a> v1.4.9 
   * <a target="_blank" href="http://chat.swim.it/scripts/angular/angular-ui-router.min.js">scripts/angular/angular-ui-router.min.js</a> v0.2.18
 
   * <a target="_blank" href="http://chat.swim.it/scripts/foundation/foundation-apps.min.js">foundation-apps.min.js</a> - Angular-powered framework from <a target="_blank" href="https://github.com/zurb/foundation-apps">https://github.com/zurb/foundation-apps</a>
   (CDN versions at https://cdnjs.com/libraries/foundation)
   <br /><br />

   The SWIM team defined a library of <strong>Angular directives</strong>

   <a target="_blank" href="https://github.com/swimit/swim-angular-js">
   https://github.com/swimit/swim-angular-js</a>

   The directives swimMap, swimList, etc. are implemented in
   <a target="_blank" href="https://github.com/swimit/swimjs/blob/master/examples/chat-presence/">
   https://github.com/swimit/swimjs/blob/master/examples/chat-presence/</a>

   * <a target="_blank" href="https://github.com/swimit/swimjs/blob/master/examples/chat-presence/chat.html">
   chat.html</a> 
   
   * <a target="_blank" href="https://github.com/swimit/swimjs/blob/master/examples/chat-presence/chat.js">
   chat.js</a>
   <br /><br />
   
   There is also file <a target="_blank" href="https://github.com/swimit/swimjs/blob/master/examples/chat-presence/swim.recon">
   swim.recon</a>
   which we examine next.



<a name="SignIn"></a>

## Sign-in using Google's Platform #

TODO: Examine the text of traffic between client and server.

   We saw in the sample <a href="#waterfallchart">waterfall timeline</a>, 
   the "platform.js" is downloaded from Google's servers to provide logic to Sign-in 
   by having the site visitor click through Google's dialog to obtain the name and email address
   instead of requesting the visitor to type it in.

0. Click the "Source" tab and click the arrows at the left to expand the code:

   <amp-img width="650" height="155" alt="swim client code in chrome 20160709-650x155-c69.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16712999/56879486-4656-11e6-82f6-fa2fc1e16667.jpg">
   </amp-img><br /><br />


### Request transmissions #



### Record Notation (recon) #

In the course of construction, SWIM developers 
created a new data format 
it calls Record Notation (RECON)
that is an improvement over regular JSON (JavaScript Object Notation).

Let's look at an example at <a target="_blank" href="https://github.com/swimit/swimjs/blob/master/examples/chat-presence/swim.recon">
https://github.com/swimit/swimjs/blob/master/examples/chat-presence/swim.recon</a>

   <pre>
@server {
  port: 5619
  store: "chat.store"
  auth: test
&nbsp;
  @route {
    prefix: "/chat/"
    service: "chat"
  }
}
&nbsp;
@service {
  name: "chat"
  main: "chat.js"
}
   </pre>

   @event, @server, @service, are <strong>datatypes</strong> called <strong>attributes</strong>.

   <a name="proto-scala"></a>

   @ack, @auth, @deauth, @event, @link, @unlink, @sync, @command, etc.
   are <strong>datatypes</strong>
   described for humans in
   <a target="_blank" href="https://github.com/swimit/swim-proto-scala">
   https://github.com/swimit/swim-proto-scala</a>


   PROTIP: RECON combines the minimalism of JSON with the expressiveness of XML in a human-friendly syntax
   to provide a "simple grammar and uniform tree model for attributed text markup."

   This approach has general applicability for other projects.
   So SWIM has structured its RECON coding to be available in several programming languages:

   * https://github.com/swimit/recon-js for the JavaScript language
   * https://github.com/swimit/recon-scala for the Scala language
   * https://github.com/swimit/recon-java for the Java language
   * https://github.com/swimit/recon-swift for the Swift language used to build iOS running on Apple iPhones and iPad devices

To use the library within a JavaScript file would involve adding to, for example, a line in:
   <a target="_blank" href="https://github.com/swimit/swimjs/blob/master/examples/chat-presence/chat.js">
   chat.js</a>

   <pre>
   var recon = require('recon-js');
   </pre>


To install:

   <tt><strong>
   npm install --save recon-js
   </strong></tt>

   The response from https://www.npmjs.com/package/recon-js

   <pre>
npm WARN saveError ENOENT: no such file or directory, open '/usr/local/bin/package.json'
npm WARN enoent ENOENT: no such file or directory, open '/usr/local/bin/package.json'
npm WARN bin No description
npm WARN bin No repository field.
npm WARN bin No README data
npm WARN bin No license field.
   </pre>

   BLAH: The above is where I'm stuck.



## RECON text formatting helpers #

To enable the Sublime Text editor to better highlight RECON-format text,
   SWIM created a file at<br />
   <a target="_blank" href="https://github.com/swimit/recon-sublime-syntax">
   https://github.com/swimit/recon-sublime-syntax</a>

0. Open the Sublime Text editor.
0. On a Mac, click the "Sublime Text" next to the Apple icon and select
   Preferences > Browse packages... to open folder:

   <pre>
   ~/Library/Application Support/Sublime Text 3/Packages
   </pre>

0. Open an internet browser instance to:

   <a target="_blank" href="https://github.com/swimit/recon-sublime-syntax">
   https://github.com/swimit/recon-sublime-syntax</a>

0. Click to download the file.
0. Unzip the file.
0. Open the folder.
0. Drag the file to the Packages folder.

   <strong>Recon.sublime-syntax</strong>

0. Save all files and restart Sublime Text.
0. View the RECON file again to see the syntax highlighting in different colors.


<a name="AddChannel"></a>

## Add Channel #

0. Click the "+" at the upper-left next to "EDIT" for this pop-up window:

   <amp-img width="588" height="131" alt="swim chat new channel 588x131-c65.jpg"
   layout="responsive" 
   src="https://cloud.githubusercontent.com/assets/300046/16711771/312101cc-462a-11e6-987a-f8dc0ea66bd2.jpg">
   </amp-img><br /><br />

0. Type in a new chat channel name and click "Create Channel".

0. Click on a topic <strong>channel</strong> at the left, such as "Public".

0. Type a message such as "hello".

   Because this app is intended for use as a demo for developers,
   it has a UI feature that is usually not in production apps.

   NEXT: We'll be examining each of the client code fragments exposed by the sample app
   as we build our own client app running locally.

0. Click on each of the "{}" to expose client code for the major functions performed by almost all clients:

   * The lower-left {} (next to the exit icon)  exposes code for<br />
   <a href="#Authenticating">Authenticating users</a>.
   * The upper-left {} (next to the EDIT icon)  exposes code for<br />
   <a href="#Synchronizing">Synchronizing chat channels</a>.
   * The lower-right {} (above the Send button) exposes code for<br />
   <a href="#Streaming">Streaming chat messages</a>.
   * The upper-right {} exposes code for<br />
   <a href="#Tracking">Tracking user presence</a>.
   * The {} to the left of the Message entry box exposes code for<br />
   <a href="#Posting">Posting a chat message</a>
   <br /><br />

   We next examine each below:


<a name="Authenticating"></a>

### Authenticating users #

   <pre>
gapi.auth2.currentUser.listen(function (googleUser) {
  if (googleUser.isSignedIn()) {
    var idToken = googleUser.getAuthResponse().id_token;
    swim.authorize('', {googleIdToken: idToken});
  }
});
   </pre>

   Notice the "gapi" is for Google API, which returns the "googleUser" object from the JavaScript closure function.

   QUESTION: What about other Single-sign-on (SSO) such as
   GitHub, Facebook, Twitter, etc.

   "swim.authorize" stores the {googleIdToken: idToken}.


<a name="Synchronizing"></a>

### Synchronizing channels #

   <pre>
Client:
&nbsp;
var channels = swim.downlink()
  .node('')
  .lane('group/chats')
  .primaryKey(function (channel) { return channel.chatUri; })
  .onEvent(function (message) {
    // redraw UI with elements of channels.state array
  })
  .sortBy('name') // sort alphabetically by channel name
  .keepAlive(true) // reconnect after network failure
  .syncMap(); // keep state synchronized
&nbsp;
Server:
&nbsp;
var groupChats = new service.MapLane().register('group/chats'); // map from chat URIs to channel info
var chatInfo = new service.JoinLane().register('chat/info'); // aggregate chat/info streams
chatInfo.onJoinEvent = function (message, downlink) {
  // called when channel info updates
  var groupChat = groupChats.get(downlink.nodeUri) || {};
  recon.set(groupChat, 'userCount', message.body.userCount); // update present user count
  groupChats.set(downlink.nodeUri, groupChat);
};
chatInfo.onJoinLinked = function (response, downlink) {
  // called when channel added to group
};
chatInfo.onJoinClose = function (downlink) {
  // called when channel removed from group
  groupChats.delete(downlink.nodeUri);
};
   </pre>

From https://github.com/swimit/swimjs:
 A downlink is a <strong>subscription</strong> to the events published by a lane. 
 Whenever the list changes on the server, the downlink updates the client. 
 In Swim terminology, a node is the URI of a particular Swim service instance.

<a name="Streaming"></a>

### Streaming messages #


   <pre>
Client:
&nbsp;
var chat = swim.downlink()
  <a href="#websockets">.node('ws://messenger.swim.services/chat/public')</a>
  <a href="#ServiceChat">.lane('chat/room')</a>
  .onEvent(function (message) {
    // redraw UI with elements of chat.state array
  })
  .keepAlive(true) // reconnect after network failure
  .syncList(); // keep state synchronized
&nbsp;
Server:
&nbsp;
var chatRoom = new service.ListLane().register('chat/room');
   </pre>


   The `swim.downlink()` coding is called "down" because
   the list of channels is obtained from the server by the code.
   Downlinks are also called "outbound" from the server.

   <a name="EndPoint"></a>

   ### API end-point #

   The `ws://` in `.node('ws://messenger.swim.services/chat/public')` coding
   uses the websockets protocol
   instead of HTTP:// protocol currently common on websites.

   QUESTION: `wss://` is the secure form of communication which makes use of encryption
   using public and private keys generated by a Certificate Authority (CA) trusted by the client.
   
   Communication is kept alive also by the `.keepAlive(true)` coding
   to reconnect after network failure and
   `.syncList()` coding to keep state (status) synchronized.

   <a name="lane"></a>

   ## lane chat/room #

   The `.lane('chat/room')` coding specifies the "lane" running in the server named "chat/room".
   Each "lane" is also called "event source".
   
   Several clients can communicate with each named lane.


<a name="Tracking"></a>

### Tracking user presence #

   <pre>
Client:
&nbsp;
var users = swim.downlink()
  .node('')
  .lane('chat/users')
  .primaryKey(function (user) { return user.email; })
  .onEvent(function (message) {
    // redraw UI with elements of users.state array
  })
  .keepAlive(true) // reconnect after network failure
  .syncMap(); // keep state synchronized
&nbsp;
Server:
&nbsp;
var chatUsers = new service.MapLane().register('chat/users');
var chatRoom = new service.ListLane().register('chat/room');
chatRoom.onEnter = function (user) {
  chatUsers.set(user.email, {email: user.email, name: user.name});
};
chatRoom.onLeave = function (user) {
  chatUsers.delete(user.email);
};
   </pre>

   The `new` keyword in coding `new service.ListLane().register('chat/room');`
   registers a new chat/room to the list of lanes within the chatRoom object
   maintained by the server.

   The `new` keyword in coding `new service.MapLane().register('chat/users');`
   registers a new user to the map of lane users  within the chatUsers object
   maintained by the server.

   The email of the user (obtained from Google)
   is the key to information about each user on the server.



<a name="Posting"></a>

### Posting a chat message #

   <pre>
Client:
&nbsp;
var message = {
  body: 'Hello, world!'
}
swim.command('', 'chat/room', message);
&nbsp;
Server:
&nbsp;
var chatRoom = new service.ListLane().register('chat/room');
   </pre>

   The "Hello, world!" text in the sample coding
   is replaced by whatever is typed in the Message field.



<a name="SignOut"></a>

## Sign-out #

0. To sign-out, click the icon on the lower-left with an arrow over a door.

   <img width="50" height="50" src="http://chat.swim.it/images/sign-out.svg" />

   This should cause the connection to close.

   QUESTION: Automatic sign-out should occur upon time-out as well?
   How long would the server keep a connection open without hearing from a client?


## Build client locally #

   NEXT: To get a even better understanding of the client app, let's construct it on a local machine.

0. A pre-requisite is to install Node.js and NPM, the Node.js Package Manager.

0. Install the Swim client using NPM:

   As described in <a target="_blank" href="https://github.com/swimit/swim-client-js">
   https://github.com/swimit/swim-client-js</a>

   <tt><strong>
   npm install --save swim-client-js
   </strong></tt>

   The response:

   <pre>
> websocket@1.0.23 install /usr/local/bin/node_modules/websocket
> (node-gyp rebuild 2> builderror.log) || (exit 0)
&nbsp;
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
  SOLINK_MODULE(target) Release/bufferutil.node
  CXX(target) Release/obj.target/validation/src/validation.o
  SOLINK_MODULE(target) Release/validation.node
npm WARN saveError ENOENT: no such file or directory, open '/usr/local/bin/package.json'
/usr/local/bin
‚îî‚îÄ‚î¨ swim-client-js@0.4.6 
  ‚îú‚îÄ‚îÄ recon-js@0.3.9 
  ‚îú‚îÄ‚îÄ swim-proto-js@0.4.2 
  ‚îî‚îÄ‚î¨ websocket@1.0.23 
    ‚îú‚îÄ‚î¨ debug@2.2.0 
    ‚îÇ ‚îî‚îÄ‚îÄ ms@0.7.1 
    ‚îú‚îÄ‚îÄ nan@2.3.5 
    ‚îú‚îÄ‚î¨ typedarray-to-buffer@3.1.2 
    ‚îÇ ‚îî‚îÄ‚îÄ is-typedarray@1.0.0 
    ‚îî‚îÄ‚îÄ yaeti@0.0.4 
&nbsp;
npm WARN enoent ENOENT: no such file or directory, open '/usr/local/bin/package.json'
npm WARN bin No description
npm WARN bin No repository field.
npm WARN bin No README data
npm WARN bin No license field. 
   </pre>


0. <strong>On a Mac OSX (MacOS)</strong>, 
   a pre-requisite is to [install Homebrew](/macos-homebrew/)
   explained by <a target="_blank" href="http://computers.tutsplus.com/tutorials/homebrew-demystified-os-xs-ultimate-package-manager--mac-44884">
   this tutorial</a>.

   Typically, Homebrew users issue a command on its own such as `brew install swimjs`.
   Homebrew would look into its GitHub.com repo for 
   a Ruby-language (.rb) file which specifies the "formula" on how to download and install "swimjs".
   This is because the SWIM organization has not populated Homebrew's GitHub repo with "swimjs.rb".

   If it had, "swimjs" would also be found in 
   http://brewformulas.org/ and
   http://braumeister.org/

   Nevertheless, Homebrew provides a <a target="_blank" href="http://formalfriday.club/2015/01/05/creating-your-own-homebrew-tap-and-formula.html">
   mechanism for <strong>custom taps</strong></a> which enables the .rb formula file to be housed in 
   a custom GitHub.com repository rather than in the Homebrew GitHub repository.

   An example of this is<br />
   <a target="_blank" href="https://github.com/Homebrew/homebrew-games">
   https://github.com/Homebrew/homebrew-games</a><br />
   which contains several formulae.

   The SWIM organization is using that custom tap mechanism,
   as described in <a target="_blank" href="https://github.com/swimit/swimjs">
   https://github.com/swimit/swimjs</a>.

0. Run the command (from any pwd) to position the GitHub repo holding the formula:

   <tt><strong>
   brew tap <a target="_blank" href="https://github.com/swimit/swim/tree/master/repo">swimit/swim</a>
   </strong></tt>

   PROTIP: The brew tap command above goes to the user or organization called "swimit" on GitHub.com.
   The name to the right of the / slash character ("swim") is the suffix to the
   Git repository name combining "homebrew-" plus "swim" from the command, 
   yielding the URL:

   <a target="_blank" href="https://github.com/swimit/homebrew-swim/">
   https://github.com/swimit/homebrew-swim</a>.

0. Click on the link above to see in the GitHub webpage that 
   there is a single brew formula file, 
   <a target="_blank" href="https://github.com/swimit/homebrew-swim/blob/master/swimjs.rb">
   swimjs.rb</a> repeated below:

   <pre>
   class Swimjs < Formula
     desc "Swim JavaScript Runtime"
     homepage "http://www.swim.it"
     url "https://raw.githubusercontent.com/swimit/swim/master/repo/swimjs-0.1.0-alpha3.tar.gz"
     version "0.1.0-alpha3"
     sha256 "d77880795f3ab904add10de351cefe6b45fc225a5754ef29c6ce75b7892105e0"
   &nbsp;
     depends_on :java => "1.8+"
   &nbsp;
     def install
       rm_f Dir["bin/*.bat"]
       libexec.install "bin", "lib"
       bin.install_symlink Dir["#{libexec}/bin/*"]
     end
   end
   }
   </pre>

   Note about the specification above:

   * The sha256 value was pre-calculated from where the file is stored before upload.
   The "hash" is based on every byte in the file.  
   The same calculation is repeated on the file after download. 
   If the output is the same, no transmission errors occurred.

   * <strong>Java 1.8+</strong> is a dependency because when the tar.gz file is expanded,
   all files in the lib folder are <strong>.jar</strong> (java archive) files.

   * The url to file <strong>swimjs-0.1.0-alpha3.tar.gz</strong> in the formula
   is among a list of files shown on a formatted web page at<br />
   <a target="_blank" href="https://github.com/swimit/swim/tree/master/repo">
   https://github.com/swimit/swim/tree/master/repo</a>

0. Click on the URL above to see the list of files available.

0. Press command+tab to select the Terminal shell window.

0. Obtain the "swimjs" formula from within the custom "swimit" tap repo:

   <tt><strong>
   brew install swimjs
   </strong></tt>

   The response contains the location of files installed:

   <pre>
   ==> Installing swimjs from swimit/swim
   ==> Downloading https://raw.githubusercontent.com/swimit/swim/master/repo/swimjs-0.1.0-alpha3.tar.gz
   Already downloaded: /Users/mac/Library/Caches/Homebrew/swimjs-0.1.0-alpha3.tar.gz
   üç∫  /usr/local/Cellar/swimjs/0.1.0-alpha3: 38 files, 17M, built in 0 seconds
   </pre>

0. View the "swimjs" formula among others in "/usr/local/Cellar/":

   <tt><strong>
   brew list
   </strong></tt>

   <a name="JarFiles"></a>

   ### .jar files #

0. Construct the path by specifying the version "0.1.0-alpha3" as a folder, then get a tree listing of the folder:

   <tt><strong>
   tree /usr/local/Cellar/swimjs/0.1.0-alpha3
   </strong></tt>

   The response (if you have tree installed):

   <pre>
|-- INSTALL_RECEIPT.json
|-- bin
|   `-- swimjs -> ../libexec/bin/swimjs
`-- libexec
    |-- bin
    |   `-- swimjs
    `-- lib
        |-- com.fasterxml.jackson.core.jackson-core-2.1.3.jar
        |-- com.google.api-client.google-api-client-1.19.1.jar
        |-- com.google.code.findbugs.jsr305-1.3.9.jar
        |-- com.google.guava.guava-jdk5-13.0.jar
        |-- com.google.http-client.google-http-client-1.19.0.jar
        |-- com.google.http-client.google-http-client-jackson2-1.19.0.jar
        |-- com.google.oauth-client.google-oauth-client-1.19.0.jar
        |-- com.h2database.h2-mvstore-1.4.191.jar
        |-- commons-codec.commons-codec-1.3.jar
        |-- commons-logging.commons-logging-1.1.1.jar
        |-- it.reify.basis-core_2.11-0.2.1.jar
        |-- it.reify.basis-data_2.11-0.2.1.jar
        |-- it.reify.basis-net_2.11-0.2.1.jar
        |-- it.reify.basis-util_2.11-0.2.1.jar
        |-- it.swim.dive-http-scala_2.11-0.1.0-SNAPSHOT.jar
        |-- it.swim.dive-httpsocket-scala_2.11-0.1.0-SNAPSHOT.jar
        |-- it.swim.dive-io-scala_2.11-0.1.0-SNAPSHOT.jar
        |-- it.swim.dive-task-scala_2.11-0.1.0-SNAPSHOT.jar
        |-- it.swim.dive-websocket-scala_2.11-0.1.0-SNAPSHOT.jar
        |-- it.swim.recon-scala_2.11-0.2.0.jar
        |-- it.swim.swim-auth-google-scala_2.11-0.3.2-SNAPSHOT.jar
        |-- it.swim.swim-core-scala_2.11-0.3.2-SNAPSHOT.jar
        |-- it.swim.swim-meta-scala_2.11-0.3.2-SNAPSHOT.jar
        |-- it.swim.swim-network-scala_2.11-0.3.2-SNAPSHOT.jar
        |-- it.swim.swim-proto-scala_2.11-0.3.1.jar
        |-- it.swim.swim-socket-scala_2.11-0.3.2-SNAPSHOT.jar
        |-- it.swim.swim-store-scala_2.11-0.3.2-SNAPSHOT.jar
        |-- it.swim.swim-util-scala_2.11-0.3.2-SNAPSHOT.jar
        |-- it.swim.swimjs-0.1.0-SNAPSHOT.jar
        |-- joda-time.joda-time-2.7.jar
        |-- org.apache.httpcomponents.httpclient-4.0.1.jar
        |-- org.apache.httpcomponents.httpcore-4.0.1.jar
        |-- org.joda.joda-convert-1.7.jar
        |-- org.scala-lang.scala-library-2.11.7.jar
        `-- org.scala-lang.scala-reflect-2.11.7.jar
&nbsp;
4 directories, 38 files
   </pre>


.jar files reveal the technologies used:

   * Joda time from http://www.joda.org/joda-time/  a quality replacement for the Java date and time classes.
   * Jackson XML processor from http://wiki.fasterxml.com/JacksonHome
   * Guava Java utility library from https://github.com/google/guava
   * Apache commons-logging for Java from https://commons.apache.org/proper/commons-logging/

   * Scala language
   * Reify.it - A foundation library for Scala focussed on efficiency and clean design

   * h2 SQL database engine from http://www.h2database.com/

All these are rather standard for new development in 2016. 

Questions:

   * JUnit ?

   * NO SQL and caching such as Redis ?

   * Performance testing benchmark results?


### Run swimjs #

0. Run in a Terminal shell window to /usr/local/Cellar/swimjs/0.1.0-alpha3/libexec/bin/swimjs
   containing 348 lines:

   <tt><strong>
   swimjs
   </strong></tt>

   The response:

   <pre>
   Loading config from /usr/local/bin/swim.recon
   Exception in thread "main" java.nio.file.NoSuchFileException: /usr/local/bin/swim.recon
	at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)
	at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)
	at sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:214)
	at java.nio.file.Files.newByteChannel(Files.java:361)
	at java.nio.file.Files.newByteChannel(Files.java:407)
	at java.nio.file.Files.readAllBytes(Files.java:3152)
	at swim.js.JavaScriptApp$.main(JavaScriptApp.scala:43)
	at swim.js.JavaScriptApp.main(JavaScriptApp.scala)
   </pre>

   Here is where I got stuck.



## iOS App #

https://github.com/swimit/swim-todo-ios

The app makes use of Apple's Swift programming language 

https://github.com/swimit/swim-swift

Built by 
	<a target="_blank" href="https://www.ewanmellor.org/">
	San Francisco based freelance iOS developer</a>
Ewan Mellor
	(<a target="_blank" href="https://github.com/ewanmellor?tab=repositories">
	ewanmellor on GitHub</a>)


## Server run-time #

https://github.com/swimit/swimjs


https://github.com/swimit/swimjs/blob/master/API.md
contains the details



## Create To Do List client #

To-Do application

https://github.com/swimit/swim-todo-services



## Java #

https://github.com/swimit/swim-util-java

   * https://github.com/swimit/recon-java


## Scala #

Developer @c9r, Chris Sachs, chris@swim.it
https://github.com/c9r
https://www.linkedin.com/in/cdsachs
has built a Scala system before


## Companies #

DownlinkBuilder: an object used to constructor outbound links.

    URL ???


## Services #

Messaging

Fine grain control over privacy data

Intra-service and Inter-service introspection 


http://enterprise.webaware.com/#/system-stats

